!< HASTY test hash table CAF basic.
program hasty_test_caf_get_clone
!-----------------------------------------------------------------------------------------------------------------------------------
!< HASTY test hash table CAF basic.
!-----------------------------------------------------------------------------------------------------------------------------------
use, intrinsic :: iso_fortran_env, only : int32, int64, error_unit
use hasty
!-----------------------------------------------------------------------------------------------------------------------------------

!-----------------------------------------------------------------------------------------------------------------------------------
type(hash_table)      :: a_table       !< A table.
class(*), allocatable :: a_new_content !< A content.
!-----------------------------------------------------------------------------------------------------------------------------------

!-----------------------------------------------------------------------------------------------------------------------------------
call a_table%initialize(buckets_number=4, use_prime=.true.)

#ifdef CAF

sync all
call a_table%add_clone(key=3_int32, content=int(this_image(), int32))
sync all

if (this_image()==2) call a_table%get_clone(key=3_int32, content=a_new_content)

#endif
!-----------------------------------------------------------------------------------------------------------------------------------
endprogram hasty_test_caf_get_clone
