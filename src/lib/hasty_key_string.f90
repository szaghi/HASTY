!< HASTY concrete string **key** class.
module hasty_key_string
!-----------------------------------------------------------------------------------------------------------------------------------
!< HASTY concrete string **key** class.
!-----------------------------------------------------------------------------------------------------------------------------------
use hasty_key_adt
!-----------------------------------------------------------------------------------------------------------------------------------

!-----------------------------------------------------------------------------------------------------------------------------------
implicit none
private
public :: key_string
!-----------------------------------------------------------------------------------------------------------------------------------

!-----------------------------------------------------------------------------------------------------------------------------------
type, extends(key_adt) :: key_string
  !< Concrete string **key** class to identify a node of list.
  character(len=:), allocatable :: key !< The string key value.
  contains
    ! private deferred methods
    procedure, pass(lhs), private :: is_equal !< Implement `==` operator.
endtype key_string
!-----------------------------------------------------------------------------------------------------------------------------------
contains
  ! private deferred methods
  elemental logical function is_equal(lhs, rhs)
  !---------------------------------------------------------------------------------------------------------------------------------
  !< Implement `==` operator.
  !---------------------------------------------------------------------------------------------------------------------------------
  class(key_string), intent(in) :: lhs !< Left hand side.
  class(key_adt),    intent(in) :: rhs !< Rigth hand side.
  !---------------------------------------------------------------------------------------------------------------------------------

  !---------------------------------------------------------------------------------------------------------------------------------
  is_equal = .false.
  select type(rhs)
  class is(key_string)
    is_equal = lhs%key==rhs%key
  endselect
  !---------------------------------------------------------------------------------------------------------------------------------
  endfunction is_equal
endmodule hasty_key_string
